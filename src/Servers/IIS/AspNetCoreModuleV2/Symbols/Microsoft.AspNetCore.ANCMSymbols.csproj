<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>netcoreapp3.0</TargetFramework>
    <IncludeBuildOutput>false</IncludeBuildOutput>
    <IsPackable>$(PackNativeAssets)</IsPackable>
    <IsShippingPackage>false</IsShippingPackage>
  </PropertyGroup>

  <Import Project="..\..\build\assets.props" />

  <ItemGroup Condition="'$(BuildIisNativeProjects)' == 'true' AND '$(VCTargetsPath)' != ''">
    <NativeProjectReference Include="$(MSBuildThisFileDirectory)..\..\AspNetCoreModuleV2\OutOfProcessRequestHandler\OutOfProcessRequestHandler.vcxproj" Platform="x64" />
    <NativeProjectReference Include="$(MSBuildThisFileDirectory)..\..\AspNetCoreModuleV2\OutOfProcessRequestHandler\OutOfProcessRequestHandler.vcxproj" Platform="Win32" />
    <NativeProjectReference Include="$(MSBuildThisFileDirectory)..\..\AspNetCoreModuleV2\AspNetCore\AspNetCore.vcxproj" Platform="x64" />
    <NativeProjectReference Include="$(MSBuildThisFileDirectory)..\..\AspNetCoreModuleV2\AspNetCore\AspNetCore.vcxproj" Platform="Win32" />
  </ItemGroup>

  <Target Name="AddPackNativeComponents" BeforeTargets="_GetPackageFiles" Condition="'$(PackNativeAssets)' == 'true'">
    <ItemGroup>
      <None Include="%(ShimComponents.DllLocation)"
            Pack="true"
            PackagePath="runtimes/win-%(ShimComponents.Platform)/native/$(NativeAssetsTargetFramework)" />
      <None Include="%(ShimComponents.PdbLocation)"
            Pack="true"
            PackagePath="runtimes/win-%(ShimComponents.Platform)/native/$(NativeAssetsTargetFramework)" />
    </ItemGroup>
  </Target>

  <!-- This project does not produce a binary. Disable the compiler. -->
  <Target Name="Compile" />
  <Target Name="CopyFilesToOutputDirectory" />
</Project>
